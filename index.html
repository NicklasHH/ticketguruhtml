<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Index</title>
    <style>
      body {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }
      form {
        text-align: center;
      }
    </style>
  </head>
  <body>
    <h3>Lipuntarkastus</h3>
    <form>
      <input type="text" id="käyttäjätunnus" value="admin" />
      <input type="text" id="salasana" value="admin" /><br /><br />

      <label for="lipunID">Lipun ID:</label>
      <input type="text" id="lipunID" value="1" />

      <button <button type="button" onclick="tarkistaLippu()">
        Tarkista lippu
      </button>
    </form>
  </body>
</html>
<script>
  function tarkistaLippu() {
    const username = document.getElementById("käyttäjätunnus").value;
    const password = document.getElementById("salasana").value;
    const lippuId = document.getElementById("lipunID").value;
    const url = `http://ticketguru-ohjelmistoprojekti.rahtiapp.fi/api/tickets/${lippuId}/check`;
    const base64Credentials = btoa(`${username}:${password}`);

    fetch(url, {
      method: "PATCH",
      headers: {
        Authorization: `Basic ${base64Credentials}`,
      },
    })
      .then((response) => {
        console.log("Palautuskoodi:", response.status);
        if (response.ok) {
          return response.json();
        } else {
          throw new Error("Virheellinen vastaus API:sta");
        }
      })
      .catch((error) => {
        console.error("Virhe:", error);
      });
  }
</script>
